<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏ - CarRental</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        .admin-header {
            background: linear-gradient(135deg, #2c5aa0, #2a9d8f);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .stats-card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand fw-bold" href="/">üöó CarRental</a>
        <div class="navbar-nav me-auto">
            <a class="nav-link" href="/">–ì–ª–∞–≤–Ω–∞—è</a>
            <a class="nav-link" href="/cars">–ê–≤—Ç–æ–º–æ–±–∏–ª–∏</a>
            <a class="nav-link active" href="/admin/cars">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ</a>
        </div>
        <div class="navbar-nav">
            <span class="navbar-text me-3">
                <i class="bi bi-person"></i>
                <span th:text="${currentUser.fullName}"></span>
                <small class="text-muted ms-2" th:text="${currentUser.role}"></small>
            </span>
            <a class="btn btn-outline-light btn-sm" href="/logout">–í—ã–π—Ç–∏</a>
        </div>
    </div>
</nav>

<div class="admin-header">
    <div class="container">
        <h1 class="display-5 fw-bold">
            <i class="bi bi-gear"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏
        </h1>
        <p class="lead mb-0">–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤</p>
    </div>
</div>

<div class="container">
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ - –£–ü–†–û–©–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card stats-card bg-primary text-white">
                <div class="card-body">
                    <h5 class="card-title">–í—Å–µ–≥–æ –∞–≤—Ç–æ</h5>
                    <h2 th:text="${cars.size()}">0</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stats-card bg-success text-white">
                <div class="card-body">
                    <h5 class="card-title">–î–æ—Å—Ç—É–ø–Ω–æ</h5>
                    <h2 th:text="${availableCount}">0</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stats-card bg-warning text-white">
                <div class="card-body">
                    <h5 class="card-title">–ó–∞–Ω—è—Ç–æ</h5>
                    <h2 th:text="${occupiedCount}">0</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card stats-card bg-info text-white">
                <div class="card-body">
                    <h5 class="card-title">–ú–æ–∏ –∞–≤—Ç–æ</h5>
                    <h2 th:text="${myCarsCount}">0</h2>
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>–°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h3>
        <a href="/admin/cars/add" class="btn btn-primary">
            <i class="bi bi-plus-circle"></i> –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å
        </a>
    </div>

    <div th:if="${success}" class="alert alert-success alert-dismissible fade show">
        <i class="bi bi-check-circle"></i>
        <span th:text="${success}">–ê–≤—Ç–æ–º–æ–±–∏–ª—å —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω!</span>
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>

    <!-- –¢–∞–±–ª–∏—Ü–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π -->
    <div class="card">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-striped table-hover">
                    <thead>
                    <tr>
                        <th>–§–æ—Ç–æ</th>
                        <th>–ê–≤—Ç–æ–º–æ–±–∏–ª—å</th>
                        <th>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</th>
                        <th>–¶–µ–Ω–∞</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–ú–µ–Ω–µ–¥–∂–µ—Ä</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="car : ${cars}">
                        <td>
                            <img th:if="${car.imageUrl}" th:src="@{${car.imageUrl}}"
                                 style="width: 60px; height: 40px; object-fit: cover;"
                                 class="rounded" th:alt="${car.brand + ' ' + car.model}">
                            <span th:unless="${car.imageUrl}" class="text-muted">–ù–µ—Ç —Ñ–æ—Ç–æ</span>
                        </td>
                        <td>
                            <strong th:text="${car.brand + ' ' + car.model}"></strong><br>
                            <small class="text-muted" th:text="${car.year} + ' –≥–æ–¥'"></small>
                        </td>
                        <td>
                            <small th:text="${car.fuelType} ?: '-'"></small><br>
                            <small th:text="${car.transmission} ?: '-'"></small>
                        </td>
                        <td>
                            <strong class="text-success" th:text="${car.pricePerDay} + ' ‚ÇΩ'"></strong>
                        </td>
                        <td>
                            <span th:if="${car.available}" class="badge bg-success">–î–æ—Å—Ç—É–ø–µ–Ω</span>
                            <span th:unless="${car.available}" class="badge bg-danger">–ó–∞–Ω—è—Ç</span>
                        </td>
                        <td>
                            <small th:if="${car.manager}" th:text="${car.manager.fullName}"></small>
                            <small th:unless="${car.manager}" class="text-muted">–ù–µ –Ω–∞–∑–Ω–∞—á–µ–Ω</small>
                        </td>
                        <td>
                            <div class="btn-group btn-group-sm">
                                <button class="btn btn-outline-warning">
                                    <i class="bi bi-pencil"></i>
                                </button>
                                <!-- –î–û–ë–ê–í–¨ –≠–¢–£ –ö–ù–û–ü–ö–£ -->
                                <a th:href="@{/admin/cars/upload-photo/{id}(id=${car.id})}"
                                   class="btn btn-outline-info">
                                    <i class="bi bi-image"></i> –§–æ—Ç–æ
                                </a>
                                <button class="btn btn-outline-danger">
                                    <i class="bi bi-trash"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>